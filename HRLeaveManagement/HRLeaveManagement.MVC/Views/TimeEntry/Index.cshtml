@model TimeEntryWithTemplateVM

@{
    var startOfWeek = Model.TimeEntry.StartWeek;
    var endOfWeek = Model.TimeEntry.EndWeek;
}

<header class="d-flex align-items-center justify-content-between bg-light p-3 shadow-sm">
    <div class="d-flex gap-2">
        <span class="bg-warning p-2 rounded"><i class="bi bi-calendar2-week text-light"></i></span>
        <h3 class="text-dark">Time Entry</h3>
    </div>
    <div>   
        <a class="btn btn-outline-primary">Copy Template Schedule</a>
        <a class="btn btn-outline-primary" asp-action="Copy">Copy From Previous Week</a>
        <input class="btn btn-outline-primary" type="submit" form="timeForm" value="Subimt"/>
    </div>
</header>

<br />
<br />

<div class="container">
    <div class="form-group d-flex gap-2 align-items-center p-3 border border-bottom-0 rounded-top">
        <span>Week Ending</span>
        <a asp-action="Index" asp-route-date="@startOfWeek.AddDays(-7).ToString("dd-MM-yy")" class="btn btn-info btn-sm"><i class="bi bi-arrow-left"></i></a>
        <div class="input-group-sm date" id="datepicker">
            <input type="text" class="form-control" value="@endOfWeek.ToShortDateString()"/>
            <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span>
            </span>
        </div>
        <a asp-action="Index" asp-route-date="@startOfWeek.AddDays(7).ToString("dd-MM-yy")" class="btn btn-info btn-sm"><i class="bi bi-arrow-right"></i></a>
    </div>    
    <table class="table table-striped table-hover border rounded-bottom">
        <thead>
            <tr>
                <th>@startOfWeek.ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(1).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(2).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(3).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(4).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(5).ToString("ddd/dd")</th>
                <th>@endOfWeek.ToString("ddd/dd")</th>
                <th>Sum</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
             <tr>
                 @if(Model.TimeEntry.Hours.Any(h => h.Hours > 0))
                 {
                    <td>@Model.TimeEntry.Hours[0].Hours</td>
                    <td>@Model.TimeEntry.Hours[1].Hours</td>
                    <td>@Model.TimeEntry.Hours[2].Hours</td>
                    <td>@Model.TimeEntry.Hours[3].Hours</td>
                    <td>@Model.TimeEntry.Hours[4].Hours</td>
                    <td>@Model.TimeEntry.Hours[5].Hours</td>
                    <td>@Model.TimeEntry.Hours[6].Hours</td>
                 }
                 else
                 {
                     <form id="timeForm" asp-action="Create">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <td>
                        <input asp-for="TimeEntry.Hours[0].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[0].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[1].Hours" type="number" class="form-control" />
                            <span asp-validation-for="TimeEntry.Hours[1].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[2].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[2].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[3].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[3].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[4].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[4].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[5].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[5].Hours" class="text-danger"></span>
                        </td>
                        <td>
                        <input asp-for="TimeEntry.Hours[6].Hours" type="number" class="form-control" />
                        <span asp-validation-for="TimeEntry.Hours[6].Hours" class="text-danger"></span>
                        </td>
                    <input asp-for="TimeEntry.StartWeek" value="@Model.TimeEntry.StartWeek" type="datetime" hidden />
                    <input asp-for="TimeEntry.EndWeek" value="@Model.TimeEntry.EndWeek" type="datetime" hidden />
                     </form>
                 }
                <td>@Model.TimeEntry.Hours.Sum(h => h.Hours)</td>
                <td></td>
             </tr>
        </tbody>
    </table>
</div>

<div class="container" style="margin-top: 5rem">
    <h4>Template Schedule</h4>
    <div class="form-group d-flex gap-2 align-items-center p-3 border border-bottom-0 rounded-top mt-3">
        <span>Week Ending</span>
        <div class="input-group-sm date" id="datepicker">
            <input type="text" class="form-control" value="@endOfWeek.ToShortDateString()" />
            <span class="input-group-addon">
                <span class="glyphicon glyphicon-calendar"></span>
            </span>
        </div>
        <input class="btn btn-outline-primary btn-sm" type="submit" form="templateForm" value="Save Schedule"/>
    </div>
    <table class="table table-striped table-hover border rounded-bottom">
        <thead>
            <tr>
                <th>@startOfWeek.ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(1).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(2).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(3).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(4).ToString("ddd/dd")</th>
                <th>@startOfWeek.AddDays(5).ToString("ddd/dd")</th>
                <th>@endOfWeek.ToString("ddd/dd")</th>
                <th>Sum</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <form id="templateForm" asp-action="SaveTemplate">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <td>
                    <input asp-for="TemplateTime.Hours1" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours1" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours2" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours2" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours3" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours3" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours4" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours4" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours5" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours5" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours6" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours6" class="text-danger"></span>
                </td>
                <td>
                    <input asp-for="TemplateTime.Hours7" type="number" class="form-control" />
                    <span asp-validation-for="TemplateTime.Hours7" class="text-danger"></span>
                </td>
                </form>
                <td>@Model.TemplateTime.Total</td>
            </tr>
        </tbody>
    </table>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('#datepicker').datepicker({
                format: 'dd/mm/yyyy',
                startDate: '01/01/2022',
                endDate: '01/01/2023'
            });
        });
    </script>
}